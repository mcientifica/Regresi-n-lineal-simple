{"cells":[{"cell_type":"code","execution_count":3,"metadata":{"id":"km4r4GbMFcFz","executionInfo":{"status":"ok","timestamp":1721813608781,"user_tz":-120,"elapsed":408,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"Pbc4TLi-FcF1","executionInfo":{"status":"ok","timestamp":1721813609078,"user_tz":-120,"elapsed":1,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["data = pd.read_csv(\"Advertising.csv\")"]},{"cell_type":"markdown","metadata":{"id":"xRRbip72FcF1"},"source":["# Flujo completo - StatModels"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"DDbIz09BFcF2","executionInfo":{"status":"ok","timestamp":1721813610617,"user_tz":-120,"elapsed":1540,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["import statsmodels.formula.api as smf"]},{"cell_type":"markdown","metadata":{"id":"kSr_9spzFcF3"},"source":["## Divido dataset en Training y Testing"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"WH5GpfrdFcF3","executionInfo":{"status":"ok","timestamp":1721813610617,"user_tz":-120,"elapsed":3,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["numeros = np.random.uniform(0,1,len(data))"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":517},"id":"iqMY5L0VFcF3","executionInfo":{"status":"ok","timestamp":1721813611037,"user_tz":-120,"elapsed":422,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"f88a6707-c221-4a60-adf0-45c6b9bd60e0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(array([19., 18., 15., 17., 20., 23., 29., 22., 21., 16.]),\n"," array([5.59308560e-04, 9.92450292e-02, 1.97930750e-01, 2.96616471e-01,\n","        3.95302191e-01, 4.93987912e-01, 5.92673632e-01, 6.91359353e-01,\n","        7.90045074e-01, 8.88730794e-01, 9.87416515e-01]),\n"," <BarContainer object of 10 artists>)"]},"metadata":{},"execution_count":7},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAh8AAAGdCAYAAACyzRGfAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAcNElEQVR4nO3df3SWdf348dcAd4O1DSeysRwKmKIodsKk5Y+0SESPZeFRs2PYMU0bnqOrzKVJZDWOdZTqIJ5Mxc6R6McRKzFMMfBoYEVwtFQKhMQjW2mx4cwbZNf3j77u0wTUe9x7z3s+Hudc53hf97XrfvGW455eu+9dZVmWZQEAkMig/h4AAHh7ER8AQFLiAwBISnwAAEmJDwAgKfEBACQlPgCApMQHAJDUkP4e4LW6urriueeei4qKiigrK+vvcQCANyHLsti2bVvU1dXFoEGvf23jLRcfzz33XNTX1/f3GABAL2zevDkOPPDA1z2moPiYP39+zJ8/PzZt2hQRERMmTIhrr702pk2bFhERL7/8cnzhC1+IRYsWRT6fj6lTp8ZNN90UNTU1b/o1KioquoevrKwsZDwAoJ90dHREfX199/fx11NWyL1dfvWrX8XgwYPj3e9+d2RZFnfccUd8+9vfjjVr1sSECRPi0ksvjSVLlsSCBQuiqqoqZs6cGYMGDYpHHnmkoOGrqqqivb1dfABAiSjk+3dB8bE71dXV8e1vfzvOOuusOOCAA2LhwoVx1llnRUTEU089FYcffnisXLky3v/+9xd9eADgraGQ79+9/rTLzp07Y9GiRdHZ2RkNDQ2xevXq2LFjR0yZMqX7mPHjx8fo0aNj5cqVezxPPp+Pjo6OHhsAMHAVHB+PP/54vPOd74xcLheXXHJJLF68OI444ohobW2N8vLyGD58eI/ja2pqorW1dY/na2lpiaqqqu7Nm00BYGArOD4OO+ywWLt2bTz66KNx6aWXxowZM+KJJ57o9QDNzc3R3t7evW3evLnX5wIA3voK/qhteXl5HHLIIRERMWnSpPjDH/4Q3/3ud+Occ86J7du3x9atW3tc/Whra4va2to9ni+Xy0Uulyt8cgCgJO31bzjt6uqKfD4fkyZNin322SeWLVvW/dy6devimWeeiYaGhr19GQBggCjoykdzc3NMmzYtRo8eHdu2bYuFCxfG8uXL47777ouqqqq48MILo6mpKaqrq6OysjIuu+yyaGhoeNOfdAEABr6C4uMf//hHfPrTn44tW7ZEVVVVTJw4Me677774yEc+EhERN954YwwaNCimT5/e45eMAQC8aq9/z0ex+T0fAFB6kvyeDwCA3hAfAEBS4gMASEp8AABJiQ8AIKmCf8MpwNvNwVct6e8RemXTnNP7ewTYLVc+AICkxAcAkJT4AACSEh8AQFLiAwBISnwAAEmJDwAgKfEBACQlPgCApMQHAJCU+AAAkhIfAEBS4gMASEp8AABJiQ8AICnxAQAkJT4AgKTEBwCQlPgAAJISHwBAUuIDAEhKfAAASYkPACAp8QEAJCU+AICkxAcAkJT4AACSEh8AQFLiAwBISnwAAEmJDwAgKfEBACQlPgCApMQHAJCU+AAAkhIfAEBS4gMASEp8AABJiQ8AICnxAQAkJT4AgKTEBwCQlPgAAJISHwBAUgXFR0tLS7zvfe+LioqKGDlyZJx55pmxbt26HsecdNJJUVZW1mO75JJLijo0AFC6CoqPFStWRGNjY6xatSruv//+2LFjR5xyyinR2dnZ47iLLrootmzZ0r1df/31RR0aAChdQwo5eOnSpT0eL1iwIEaOHBmrV6+OE088sXv/vvvuG7W1tcWZEAAYUPbqPR/t7e0REVFdXd1j/5133hkjRoyII488Mpqbm+Oll17a4zny+Xx0dHT02ACAgaugKx//q6urKy6//PI47rjj4sgjj+zef95558VBBx0UdXV18dhjj8WXv/zlWLduXdx11127PU9LS0vMnj27t2MAACWmLMuyrDdfeOmll8avf/3rePjhh+PAAw/c43EPPvhgfPjDH47169fHuHHjdnk+n89HPp/vftzR0RH19fXR3t4elZWVvRkNoKgOvmpJf4/QK5vmnN7fI/A20tHREVVVVW/q+3evrnzMnDkz7rnnnnjooYdeNzwiIiZPnhwRscf4yOVykcvlejMGAFCCCoqPLMvisssui8WLF8fy5ctjzJgxb/g1a9eujYiIUaNG9WpAAGBgKSg+GhsbY+HChfGLX/wiKioqorW1NSIiqqqqYtiwYbFhw4ZYuHBhnHbaabH//vvHY489FldccUWceOKJMXHixD75AwAApaWg+Jg/f35E/PcXif2v22+/PS644IIoLy+PBx54IObOnRudnZ1RX18f06dPj2uuuaZoAwMApa3g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\n"},"metadata":{}}],"source":["plt.hist(numeros)"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"l7OZMbogFcF4","executionInfo":{"status":"ok","timestamp":1721813611037,"user_tz":-120,"elapsed":7,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["filtro = (numeros<0.75)\n","training = data[filtro]\n","testing = data[~filtro]"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bOOZeAbvFcF4","executionInfo":{"status":"ok","timestamp":1721813611038,"user_tz":-120,"elapsed":8,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"087bcecd-5960-427d-b883-5628eaad898e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(153, 4)"]},"metadata":{},"execution_count":9}],"source":["training.shape"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-4JD-2vqFcF5","executionInfo":{"status":"ok","timestamp":1721813611038,"user_tz":-120,"elapsed":7,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"9491b20a-b9e9-4dd4-c488-e9a0c52d51c2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(47, 4)"]},"metadata":{},"execution_count":10}],"source":["testing.shape"]},{"cell_type":"markdown","metadata":{"id":"6ePsbdvBFcF5"},"source":["## Valido que exista al menos una variable relevante"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9vAs8FVWFcF5","executionInfo":{"status":"ok","timestamp":1721813611038,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"e5ed29b1-f148-45a3-cc25-92ab2ee56c81"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Intercept    1.198205e-12\n","TV           2.307995e-59\n","Radio        3.264699e-38\n","Newspaper    8.568063e-01\n","dtype: float64"]},"metadata":{},"execution_count":11}],"source":["lm = smf.ols(formula=\"Sales~TV+Radio+Newspaper\", data=training).fit()\n","lm.pvalues # hay al menos una variable con p-valor menor a 0.5"]},{"cell_type":"markdown","metadata":{"id":"W71NY93LFcF5"},"source":["## Selecciono variables relevantes"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"sh0FS2JuFcF5","executionInfo":{"status":"ok","timestamp":1721813611039,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["# Este paso es lo mismo que hicimos antes de verificar cual era la combinación de variables que mejor resultado entregaba\n","# vamos a asumir que el mejor modelo es Sales~TV+Radio"]},{"cell_type":"markdown","metadata":{"id":"r6aeB4c1FcF5"},"source":["## Ajustar el modelo con datos de training"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"nACS_teUFcF5","executionInfo":{"status":"ok","timestamp":1721813611039,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["import statsmodels.formula.api as smf\n","lm = smf.ols(formula=\"Sales~TV+Radio\", data=training).fit()"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":465},"id":"xPuW_yRdFcF5","executionInfo":{"status":"ok","timestamp":1721813611340,"user_tz":-120,"elapsed":3,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"5c9585f0-fdee-4b12-98d3-80948f4cfd89"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<class 'statsmodels.iolib.summary.Summary'>\n","\"\"\"\n","                            OLS Regression Results                            \n","==============================================================================\n","Dep. Variable:                  Sales   R-squared:                       0.880\n","Model:                            OLS   Adj. R-squared:                  0.879\n","Method:                 Least Squares   F-statistic:                     552.6\n","Date:                Wed, 24 Jul 2024   Prob (F-statistic):           6.38e-70\n","Time:                        09:33:35   Log-Likelihood:                -304.10\n","No. Observations:                 153   AIC:                             614.2\n","Df Residuals:                     150   BIC:                             623.3\n","Df Model:                           2                                         \n","Covariance Type:            nonrobust                                         \n","==============================================================================\n","                 coef    std err          t      P>|t|      [0.025      0.975]\n","------------------------------------------------------------------------------\n","Intercept      2.9368      0.355      8.266      0.000       2.235       3.639\n","TV             0.0457      0.002     27.202      0.000       0.042       0.049\n","Radio          0.1833      0.010     18.834      0.000       0.164       0.203\n","==============================================================================\n","Omnibus:                       43.713   Durbin-Watson:                   2.009\n","Prob(Omnibus):                  0.000   Jarque-Bera (JB):               93.195\n","Skew:                          -1.250   Prob(JB):                     5.79e-21\n","Kurtosis:                       5.894   Cond. No.                         422.\n","==============================================================================\n","\n","Notes:\n","[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n","\"\"\""],"text/html":["<table class=\"simpletable\">\n","<caption>OLS Regression Results</caption>\n","<tr>\n","  <th>Dep. Variable:</th>          <td>Sales</td>      <th>  R-squared:         </th> <td>   0.880</td>\n","</tr>\n","<tr>\n","  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.879</td>\n","</tr>\n","<tr>\n","  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   552.6</td>\n","</tr>\n","<tr>\n","  <th>Date:</th>             <td>Wed, 24 Jul 2024</td> <th>  Prob (F-statistic):</th> <td>6.38e-70</td>\n","</tr>\n","<tr>\n","  <th>Time:</th>                 <td>09:33:35</td>     <th>  Log-Likelihood:    </th> <td> -304.10</td>\n","</tr>\n","<tr>\n","  <th>No. Observations:</th>      <td>   153</td>      <th>  AIC:               </th> <td>   614.2</td>\n","</tr>\n","<tr>\n","  <th>Df Residuals:</th>          <td>   150</td>      <th>  BIC:               </th> <td>   623.3</td>\n","</tr>\n","<tr>\n","  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>   \n","</tr>\n","<tr>\n","  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n","</tr>\n","</table>\n","<table class=\"simpletable\">\n","<tr>\n","      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n","</tr>\n","<tr>\n","  <th>Intercept</th> <td>    2.9368</td> <td>    0.355</td> <td>    8.266</td> <td> 0.000</td> <td>    2.235</td> <td>    3.639</td>\n","</tr>\n","<tr>\n","  <th>TV</th>        <td>    0.0457</td> <td>    0.002</td> <td>   27.202</td> <td> 0.000</td> <td>    0.042</td> <td>    0.049</td>\n","</tr>\n","<tr>\n","  <th>Radio</th>     <td>    0.1833</td> <td>    0.010</td> <td>   18.834</td> <td> 0.000</td> <td>    0.164</td> <td>    0.203</td>\n","</tr>\n","</table>\n","<table class=\"simpletable\">\n","<tr>\n","  <th>Omnibus:</th>       <td>43.713</td> <th>  Durbin-Watson:     </th> <td>   2.009</td>\n","</tr>\n","<tr>\n","  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  93.195</td>\n","</tr>\n","<tr>\n","  <th>Skew:</th>          <td>-1.250</td> <th>  Prob(JB):          </th> <td>5.79e-21</td>\n","</tr>\n","<tr>\n","  <th>Kurtosis:</th>      <td> 5.894</td> <th>  Cond. No.          </th> <td>    422.</td>\n","</tr>\n","</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified."],"text/latex":"\\begin{center}\n\\begin{tabular}{lclc}\n\\toprule\n\\textbf{Dep. Variable:}    &      Sales       & \\textbf{  R-squared:         } &     0.880   \\\\\n\\textbf{Model:}            &       OLS        & \\textbf{  Adj. R-squared:    } &     0.879   \\\\\n\\textbf{Method:}           &  Least Squares   & \\textbf{  F-statistic:       } &     552.6   \\\\\n\\textbf{Date:}             & Wed, 24 Jul 2024 & \\textbf{  Prob (F-statistic):} &  6.38e-70   \\\\\n\\textbf{Time:}             &     09:33:35     & \\textbf{  Log-Likelihood:    } &   -304.10   \\\\\n\\textbf{No. Observations:} &         153      & \\textbf{  AIC:               } &     614.2   \\\\\n\\textbf{Df Residuals:}     &         150      & \\textbf{  BIC:               } &     623.3   \\\\\n\\textbf{Df Model:}         &           2      & \\textbf{                     } &             \\\\\n\\textbf{Covariance Type:}  &    nonrobust     & \\textbf{                     } &             \\\\\n\\bottomrule\n\\end{tabular}\n\\begin{tabular}{lcccccc}\n                   & \\textbf{coef} & \\textbf{std err} & \\textbf{t} & \\textbf{P$> |$t$|$} & \\textbf{[0.025} & \\textbf{0.975]}  \\\\\n\\midrule\n\\textbf{Intercept} &       2.9368  &        0.355     &     8.266  &         0.000        &        2.235    &        3.639     \\\\\n\\textbf{TV}        &       0.0457  &        0.002     &    27.202  &         0.000        &        0.042    &        0.049     \\\\\n\\textbf{Radio}     &       0.1833  &        0.010     &    18.834  &         0.000        &        0.164    &        0.203     \\\\\n\\bottomrule\n\\end{tabular}\n\\begin{tabular}{lclc}\n\\textbf{Omnibus:}       & 43.713 & \\textbf{  Durbin-Watson:     } &    2.009  \\\\\n\\textbf{Prob(Omnibus):} &  0.000 & \\textbf{  Jarque-Bera (JB):  } &   93.195  \\\\\n\\textbf{Skew:}          & -1.250 & \\textbf{  Prob(JB):          } & 5.79e-21  \\\\\n\\textbf{Kurtosis:}      &  5.894 & \\textbf{  Cond. No.          } &     422.  \\\\\n\\bottomrule\n\\end{tabular}\n%\\caption{OLS Regression Results}\n\\end{center}\n\nNotes: \\newline\n [1] Standard Errors assume that the covariance matrix of the errors is correctly specified."},"metadata":{},"execution_count":14}],"source":["lm.summary()"]},{"cell_type":"markdown","metadata":{"id":"c8l7rGNXFcF6"},"source":["### Statmodels"]},{"cell_type":"code","execution_count":15,"metadata":{"id":"bIXQmfYpFcF6","executionInfo":{"status":"ok","timestamp":1721813611932,"user_tz":-120,"elapsed":595,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["import statsmodels.api as sm\n","x = sm.add_constant(training[[\"TV\", \"Radio\"]])\n","y = training[\"Sales\"]\n","lm = sm.OLS(y, x).fit()"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e6NtvibRFcF6","executionInfo":{"status":"ok","timestamp":1721813611932,"user_tz":-120,"elapsed":6,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"03c317c3-23fd-4ac2-f525-e94e1145eed6"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0      22.1\n","1      10.4\n","2       9.3\n","3      18.5\n","4      12.9\n","       ... \n","194    17.3\n","195     7.6\n","196     9.7\n","197    12.8\n","199    13.4\n","Name: Sales, Length: 153, dtype: float64"]},"metadata":{},"execution_count":16}],"source":["y"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":465},"id":"ij6nx_FQFcF6","executionInfo":{"status":"ok","timestamp":1721813611933,"user_tz":-120,"elapsed":6,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"7fc77573-7564-410a-98f1-9b38ed6fb1c6"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<class 'statsmodels.iolib.summary.Summary'>\n","\"\"\"\n","                            OLS Regression Results                            \n","==============================================================================\n","Dep. Variable:                  Sales   R-squared:                       0.880\n","Model:                            OLS   Adj. R-squared:                  0.879\n","Method:                 Least Squares   F-statistic:                     552.6\n","Date:                Wed, 24 Jul 2024   Prob (F-statistic):           6.38e-70\n","Time:                        09:33:36   Log-Likelihood:                -304.10\n","No. Observations:                 153   AIC:                             614.2\n","Df Residuals:                     150   BIC:                             623.3\n","Df Model:                           2                                         \n","Covariance Type:            nonrobust                                         \n","==============================================================================\n","                 coef    std err          t      P>|t|      [0.025      0.975]\n","------------------------------------------------------------------------------\n","const          2.9368      0.355      8.266      0.000       2.235       3.639\n","TV             0.0457      0.002     27.202      0.000       0.042       0.049\n","Radio          0.1833      0.010     18.834      0.000       0.164       0.203\n","==============================================================================\n","Omnibus:                       43.713   Durbin-Watson:                   2.009\n","Prob(Omnibus):                  0.000   Jarque-Bera (JB):               93.195\n","Skew:                          -1.250   Prob(JB):                     5.79e-21\n","Kurtosis:                       5.894   Cond. No.                         422.\n","==============================================================================\n","\n","Notes:\n","[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n","\"\"\""],"text/html":["<table class=\"simpletable\">\n","<caption>OLS Regression Results</caption>\n","<tr>\n","  <th>Dep. Variable:</th>          <td>Sales</td>      <th>  R-squared:         </th> <td>   0.880</td>\n","</tr>\n","<tr>\n","  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.879</td>\n","</tr>\n","<tr>\n","  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   552.6</td>\n","</tr>\n","<tr>\n","  <th>Date:</th>             <td>Wed, 24 Jul 2024</td> <th>  Prob (F-statistic):</th> <td>6.38e-70</td>\n","</tr>\n","<tr>\n","  <th>Time:</th>                 <td>09:33:36</td>     <th>  Log-Likelihood:    </th> <td> -304.10</td>\n","</tr>\n","<tr>\n","  <th>No. Observations:</th>      <td>   153</td>      <th>  AIC:               </th> <td>   614.2</td>\n","</tr>\n","<tr>\n","  <th>Df Residuals:</th>          <td>   150</td>      <th>  BIC:               </th> <td>   623.3</td>\n","</tr>\n","<tr>\n","  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>   \n","</tr>\n","<tr>\n","  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n","</tr>\n","</table>\n","<table class=\"simpletable\">\n","<tr>\n","    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n","</tr>\n","<tr>\n","  <th>const</th> <td>    2.9368</td> <td>    0.355</td> <td>    8.266</td> <td> 0.000</td> <td>    2.235</td> <td>    3.639</td>\n","</tr>\n","<tr>\n","  <th>TV</th>    <td>    0.0457</td> <td>    0.002</td> <td>   27.202</td> <td> 0.000</td> <td>    0.042</td> <td>    0.049</td>\n","</tr>\n","<tr>\n","  <th>Radio</th> <td>    0.1833</td> <td>    0.010</td> <td>   18.834</td> <td> 0.000</td> <td>    0.164</td> <td>    0.203</td>\n","</tr>\n","</table>\n","<table class=\"simpletable\">\n","<tr>\n","  <th>Omnibus:</th>       <td>43.713</td> <th>  Durbin-Watson:     </th> <td>   2.009</td>\n","</tr>\n","<tr>\n","  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  93.195</td>\n","</tr>\n","<tr>\n","  <th>Skew:</th>          <td>-1.250</td> <th>  Prob(JB):          </th> <td>5.79e-21</td>\n","</tr>\n","<tr>\n","  <th>Kurtosis:</th>      <td> 5.894</td> <th>  Cond. No.          </th> <td>    422.</td>\n","</tr>\n","</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified."],"text/latex":"\\begin{center}\n\\begin{tabular}{lclc}\n\\toprule\n\\textbf{Dep. Variable:}    &      Sales       & \\textbf{  R-squared:         } &     0.880   \\\\\n\\textbf{Model:}            &       OLS        & \\textbf{  Adj. R-squared:    } &     0.879   \\\\\n\\textbf{Method:}           &  Least Squares   & \\textbf{  F-statistic:       } &     552.6   \\\\\n\\textbf{Date:}             & Wed, 24 Jul 2024 & \\textbf{  Prob (F-statistic):} &  6.38e-70   \\\\\n\\textbf{Time:}             &     09:33:36     & \\textbf{  Log-Likelihood:    } &   -304.10   \\\\\n\\textbf{No. Observations:} &         153      & \\textbf{  AIC:               } &     614.2   \\\\\n\\textbf{Df Residuals:}     &         150      & \\textbf{  BIC:               } &     623.3   \\\\\n\\textbf{Df Model:}         &           2      & \\textbf{                     } &             \\\\\n\\textbf{Covariance Type:}  &    nonrobust     & \\textbf{                     } &             \\\\\n\\bottomrule\n\\end{tabular}\n\\begin{tabular}{lcccccc}\n               & \\textbf{coef} & \\textbf{std err} & \\textbf{t} & \\textbf{P$> |$t$|$} & \\textbf{[0.025} & \\textbf{0.975]}  \\\\\n\\midrule\n\\textbf{const} &       2.9368  &        0.355     &     8.266  &         0.000        &        2.235    &        3.639     \\\\\n\\textbf{TV}    &       0.0457  &        0.002     &    27.202  &         0.000        &        0.042    &        0.049     \\\\\n\\textbf{Radio} &       0.1833  &        0.010     &    18.834  &         0.000        &        0.164    &        0.203     \\\\\n\\bottomrule\n\\end{tabular}\n\\begin{tabular}{lclc}\n\\textbf{Omnibus:}       & 43.713 & \\textbf{  Durbin-Watson:     } &    2.009  \\\\\n\\textbf{Prob(Omnibus):} &  0.000 & \\textbf{  Jarque-Bera (JB):  } &   93.195  \\\\\n\\textbf{Skew:}          & -1.250 & \\textbf{  Prob(JB):          } & 5.79e-21  \\\\\n\\textbf{Kurtosis:}      &  5.894 & \\textbf{  Cond. No.          } &     422.  \\\\\n\\bottomrule\n\\end{tabular}\n%\\caption{OLS Regression Results}\n\\end{center}\n\nNotes: \\newline\n [1] Standard Errors assume that the covariance matrix of the errors is correctly specified."},"metadata":{},"execution_count":17}],"source":["lm.summary()"]},{"cell_type":"markdown","metadata":{"id":"1U7QDDaTFcF6"},"source":["Sales = 2.7012 + 0.0470 * TV + 0.1872 * Radio"]},{"cell_type":"markdown","metadata":{"id":"2TS0wzDxFcF6"},"source":["## Validación del modelo con el conjunto de testing"]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":304},"id":"94JICxurFcF6","executionInfo":{"status":"error","timestamp":1721813611933,"user_tz":-120,"elapsed":6,"user":{"displayName":"David","userId":"13024953833381166534"}},"outputId":"9a91d51d-044d-4875-8cad-a3c47575c4eb"},"outputs":[{"output_type":"error","ename":"ValueError","evalue":"shapes (47,2) and (3,) not aligned: 2 (dim 1) != 3 (dim 0)","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-18-91da24c62ed5>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mtesting\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloc\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"sales_pred\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlm\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtesting\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"TV\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"Radio\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mtesting\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/statsmodels/base/model.py\u001b[0m in \u001b[0;36mpredict\u001b[0;34m(self, exog, transform, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1172\u001b[0m                                                         transform=transform)\n\u001b[1;32m   1173\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1174\u001b[0;31m         predict_results = self.model.predict(self.params, exog, *args,\n\u001b[0m\u001b[1;32m   1175\u001b[0m                                              **kwargs)\n\u001b[1;32m   1176\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/statsmodels/regression/linear_model.py\u001b[0m in \u001b[0;36mpredict\u001b[0;34m(self, params, exog)\u001b[0m\n\u001b[1;32m    410\u001b[0m             \u001b[0mexog\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexog\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    411\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 412\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mexog\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparams\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    413\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    414\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mget_distribution\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparams\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mscale\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mexog\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdist_class\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mValueError\u001b[0m: shapes (47,2) and (3,) not aligned: 2 (dim 1) != 3 (dim 0)"]}],"source":["testing.loc[:,\"sales_pred\"] = lm.predict(testing[[\"TV\", \"Radio\"]])\n","testing.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"U4NXAB8lFcF6","executionInfo":{"status":"aborted","timestamp":1721813611933,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["ECM = sum((testing[\"Sales\"]-testing[\"sales_pred\"])**2)\n","ECM"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QdwEer6-FcF6","executionInfo":{"status":"aborted","timestamp":1721813611933,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["EE = np.sqrt(ECM/(len(testing)-2-1))\n","EE"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jmQVv6aOFcF6","executionInfo":{"status":"aborted","timestamp":1721813611934,"user_tz":-120,"elapsed":6,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["sales_mean = np.mean(testing[\"Sales\"])\n","error = EE/sales_mean\n","error"]},{"cell_type":"markdown","metadata":{"id":"MkC6LHEKFcF6"},"source":["# Flujo completo - Scikit-learn"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uZUUP30iFcF6","executionInfo":{"status":"aborted","timestamp":1721813611934,"user_tz":-120,"elapsed":3917,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["import sklearn.feature_selection as seleccion\n","from sklearn.svm import SVR"]},{"cell_type":"markdown","metadata":{"id":"HmIXWTIAFcF7"},"source":["## Divido dataset en Training y Testing"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qUQGE6QDFcF7","executionInfo":{"status":"aborted","timestamp":1721813611935,"user_tz":-120,"elapsed":3917,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["data = pd.read_csv(\"Advertising.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nKQxo4LNFcF7","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["X = data[[\"TV\", \"Radio\", \"Newspaper\"]]\n","Y = data[\"Sales\"]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"17ZGnZe7FcF7","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","X_train, X_test, y_train, y_test = train_test_split(\n","    X, Y,\n","    train_size = 0.75,\n","    test_size = 0.25\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J7DuCu1aFcF7","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["X_train.shape, X_test.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AvmKvCFqFcF7","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["y_train.shape, y_test.shape"]},{"cell_type":"markdown","metadata":{"id":"1YIizdxeFcF7"},"source":["## Valido que exista al menos una variable relevante y selecciono las relevantes"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kGXBRTocFcF7","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["estimator = SVR(kernel=\"linear\") # crea un estimador lineal"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wldbz-d3FcF7","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["selector = RFE(\n","    estimator,\n","    n_features_to_select=3 # tengo que indicar cuantas variables debe seleccionar\n",") # backward selection (recursivo)\n","selector = selector.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3R5w7NK5FcF7","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["# me indica que las primeras dos columnas son las que debo seleccionar\n","selector.support_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DFiwVgT6FcF_","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["data.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ly6XXuxZFcF_","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["X_train_final = X_train.loc[:,selector.support_]\n","X_train_final.head()"]},{"cell_type":"markdown","metadata":{"id":"VfCCz3jqFcF_"},"source":["## Ajustar el modelo con datos de training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rFYgSueIFcF_","executionInfo":{"status":"aborted","timestamp":1721813612308,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["from sklearn.linear_model import LinearRegression"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OX3B4MabFcF_","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["lm = LinearRegression()\n","lm.fit(X_train_final, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-Ss4zAPHFcF_","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["# coeficientes\n","lm.coef_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CCP69GlsFcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["# intercepto\n","lm.intercept_"]},{"cell_type":"markdown","metadata":{"id":"43RMkg8xFcGA"},"source":["## Validación del modelo con el conjunto de testing"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5m2fbhc8FcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["# R^2\n","lm.score(X_test.loc[:,selector.support_], y_test)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Pg4-XeJZFcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["print(dir(lm))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Xp62Stb6FcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["lm.predict(X_test.loc[:,selector.support_])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zFguTTdIFcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["prediccion = lm.predict(X_test.loc[:,selector.support_])\n","prediccion"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z8BVR4FNFcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LHjZC6YtFcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["ECM = sum((y_test - prediccion)**2)\n","ECM"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Kf-gtcZuFcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":5,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["EE = np.sqrt(ECM/(len(testing)-2-1))\n","EE"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bOodw9VXFcGA","executionInfo":{"status":"aborted","timestamp":1721813612309,"user_tz":-120,"elapsed":4,"user":{"displayName":"David","userId":"13024953833381166534"}}},"outputs":[],"source":["sales_mean = np.mean(testing[\"Sales\"])\n","error = EE/sales_mean\n","error"]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.7"},"colab":{"provenance":[]}},"nbformat":4,"nbformat_minor":0}